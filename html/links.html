<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Lucasfy Music</title>
  <style>
    :root{
      --green:#1fb35a; /* principal */
      --black:#0b0b0b;
      --white:#ffffff;
      --glass: rgba(255,255,255,0.06);
      --card-radius:14px;
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }
    *{box-sizing:border-box}
    body{margin:0;background:linear-gradient(180deg,var(--black) 0%, #07120b 100%);color:var(--white);min-height:100vh}
    header{display:flex;align-items:center;gap:16px;padding:18px 28px;border-bottom:1px solid rgba(255,255,255,0.04);background:linear-gradient(90deg, rgba(0,0,0,0.6), rgba(0,0,0,0.2));}
    .logo{display:flex;align-items:center;gap:12px}
    .logo .badge{width:44px;height:44px;border-radius:10px;background:var(--green);display:flex;align-items:center;justify-content:center;font-weight:700;color:var(--black);font-size:18px}
    h1{font-size:18px;margin:0}
    main{display:grid;grid-template-columns:260px 1fr 320px;gap:18px;padding:20px}

    /* Sidebar artists */
    .artists{background:rgba(255,255,255,0.03);padding:14px;border-radius:var(--card-radius);min-height:480px}
    .artists h2{margin:0 0 8px 0;font-size:14px}
    .artist-list{display:flex;flex-direction:column;gap:8px}
    .artist{padding:10px;border-radius:10px;cursor:pointer;display:flex;align-items:center;gap:10px}
    .artist:hover{background:rgba(255,255,255,0.02)}
    .artist .avatar{width:44px;height:44;border-radius:8px;background:linear-gradient(180deg,var(--green),#14a84a);display:flex;align-items:center;justify-content:center;color:var(--black);font-weight:700}

    /* Center - songs */
    .songs{background:rgba(255,255,255,0.03);padding:16px;border-radius:var(--card-radius);min-height:480px}
    .songs h2{margin:0 0 6px 0}
    .song-list{margin-top:12px;display:flex;flex-direction:column;gap:10px}
    .song-item{display:flex;align-items:center;justify-content:space-between;padding:12px;border-radius:10px;background:linear-gradient(180deg, rgba(255,255,255,0.01), transparent)}
    .song-meta{display:flex;align-items:center;gap:12px}
    .play-btn{background:var(--green);border:none;padding:8px 12px;border-radius:8px;color:var(--black);font-weight:700;cursor:pointer}
    .like-btn{background:transparent;border:1px solid rgba(255,255,255,0.08);padding:6px 8px;border-radius:8px;color:var(--white);cursor:pointer}
    .add-btn{background:transparent;border:1px dashed rgba(255,255,255,0.06);padding:6px 8px;border-radius:8px;color:var(--white);cursor:pointer}

    /* Right - playlist & liked */
    .panel{background:rgba(255,255,255,0.03);padding:14px;border-radius:var(--card-radius);min-height:480px}
    .panel h3{margin:4px 0 8px 0}
    .list{display:flex;flex-direction:column;gap:8px;max-height:330px;overflow:auto;padding-right:6px}
    .list-item{display:flex;justify-content:space-between;align-items:center;padding:8px;border-radius:8px;background:rgba(255,255,255,0.01)}
    footer.player{position:fixed;left:50%;transform:translateX(-50%);bottom:18px;background:var(--black);border-radius:12px;padding:10px 16px;display:flex;gap:12px;align-items:center;border:1px solid rgba(255,255,255,0.04)}

    /* responsive */
    @media (max-width:980px){main{grid-template-columns:1fr;padding:12px}footer.player{left:12px;transform:none;width:calc(100% - 24px)}.panel{display:none}}

    /* small helpers */
    .muted{color:rgba(255,255,255,0.6);font-size:13px}
    .pill{background:rgba(0,0,0,0.4);padding:6px 8px;border-radius:999px;border:1px solid rgba(255,255,255,0.03)}
  </style>
</head>
<body>
  <header>
    <div class="logo">
      <div class="badge">LF</div>
      <div>
        <h1>Lucasfy Music</h1>
        <div class="muted">Sua m√∫sica, seu clima ‚Äî verde, branco e preto</div>
      </div>
    </div>
  </header>

  <main>
    <section class="artists">
      <h2>Artistas</h2>
      <div class="artist-list" id="artistList"></div>
    </section>

    <section class="songs">
      <h2 id="artistTitle">Escolha um artista</h2>
      <div class="muted" id="artistDesc">Clique em um artista √† esquerda para ver as m√∫sicas.</div>
      <div class="song-list" id="songList"></div>
    </section>

    <aside class="panel">
      <h3>Playlist</h3>
      <div class="list" id="playlist"></div>
      <div style="height:12px"></div>
      <h3>M√∫sicas Curtidas</h3>
      <div class="list" id="likedList"></div>
      <div style="height:12px"></div>
      <button class="pill" id="clearStorage">Limpar Dados Locais</button>
    </aside>
  </main>

  <footer class="player">
    <div id="nowPlaying">Nenhuma m√∫sica reproduzida</div>
    <div style="flex:1"></div>
    <button id="stopBtn" class="pill">Parar</button>
  </footer>

  <script>
    // Dados dos artistas e m√∫sicas
    const DB = [
      {
        id: 'kali', name: 'Kali Uchis', songs: [
          {id:'telepatia', title:'Telepat√≠a', duration:'3:38'},
          {id:'after', title:'After The Storm', duration:'2:55'},
          {id:'dead', title:'Dead To Me', duration:'3:04'},
          {id:'lottery', title:'Lottery', duration:'2:50'}
        ]
      },
      {
        id: 'jorge', name: 'Jorge Matheus', songs: [
          {id:'pode', title:'Pode Chorar', duration:'3:10'},
          {id:'cheirosa', title:'Cheirosa', duration:'3:05'},
          {id:'amo', title:'Amo Noite e Dia', duration:'2:58'},
          {id:'sosseguei', title:'Sosseguei', duration:'3:12'}
        ]
      },
      {
        id: 'bin', name: 'Bin', songs: [
          {id:'bin1', title:'Noite Urbana', duration:'2:44'},
          {id:'bin2', title:'Ruas e Luzes', duration:'3:11'},
          {id:'bin3', title:'Fluxo', duration:'3:26'},
          {id:'bin4', title:'C√©u de Pedra', duration:'2:59'}
        ]
      },
      {
        id: 'eminem', name: 'Eminem', songs: [
          {id:'lose', title:'Lose Yourself', duration:'5:20'},
          {id:'stan', title:'Stan', duration:'6:44'},
          {id:'without', title:'Without Me', duration:'4:50'},
          {id:'real', title:'The Real Slim Shady', duration:'4:44'}
        ]
      },
      {
        id: 'thalles', name: 'Thalles Roberto', songs: [
          {id:'faz', title:'Faz Chover', duration:'4:12'},
          {id:'rest', title:'Restitui√ß√£o', duration:'4:01'},
          {id:'deus', title:'Deus do Imposs√≠vel', duration:'3:30'},
          {id:'restaur', title:'A Restaura√ß√£o', duration:'3:58'}
        ]
      }
    ];

    // Estado
    let state = {
      currentArtist: null,
      playing: null,
      playlist: JSON.parse(localStorage.getItem('lucasfy_playlist')||'[]'),
      liked: new Set(JSON.parse(localStorage.getItem('lucasfy_liked')||'[]'))
    };

    // Audio: sintetizador simples usando Web Audio API (sem arquivos externos)
    const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
    let osc = null, gain = null;
    function playTone(durationSeconds=3){
      stopTone();
      osc = audioCtx.createOscillator();
      gain = audioCtx.createGain();
      osc.type = 'sine';
      osc.frequency.value = 440; // A4
      gain.gain.value = 0.0001;
      osc.connect(gain);
      gain.connect(audioCtx.destination);
      const now = audioCtx.currentTime;
      gain.gain.setValueAtTime(0.0001, now);
      gain.gain.exponentialRampToValueAtTime(0.12, now + 0.02);
      osc.start(now);
      gain.gain.exponentialRampToValueAtTime(0.0001, now + durationSeconds);
      osc.stop(now + durationSeconds + 0.05);
      // cleanup
      setTimeout(()=>{stopTone();}, (durationSeconds+2000));
    }
    function stopTone(){
      try{ if(osc){ osc.disconnect(); osc=null } if(gain){ gain.disconnect(); gain=null } }catch(e){}
    }

    // UI render
    const artistListEl = document.getElementById('artistList');
    const songListEl = document.getElementById('songList');
    const artistTitleEl = document.getElementById('artistTitle');
    const artistDescEl = document.getElementById('artistDesc');
    const playlistEl = document.getElementById('playlist');
    const likedListEl = document.getElementById('likedList');
    const nowPlayingEl = document.getElementById('nowPlaying');

    function renderArtists(){
      artistListEl.innerHTML = '';
      DB.forEach(a=>{
        const div = document.createElement('div');
        div.className='artist';
        div.innerHTML = `<div class='avatar'>${a.name.split(' ').map(s=>s[0]).slice(0,2).join('')}</div><div><strong>${a.name}</strong><div class='muted'>${a.songs.length} faixas</div></div>`;
        div.onclick = ()=>selectArtist(a.id);
        artistListEl.appendChild(div);
      });
    }

    function selectArtist(id){
      const artist = DB.find(x=>x.id===id);
      state.currentArtist = artist;
      artistTitleEl.textContent = artist.name;
      artistDescEl.textContent = `${artist.songs.length} m√∫sicas ‚Äî clique em ‚ñ∂ para reproduzir, üíö para curtir, + para adicionar √† playlist.`;
      renderSongs(artist.songs);
    }

    function renderSongs(songs){
      songListEl.innerHTML = '';
      songs.forEach(s=>{
        const item = document.createElement('div');
        item.className='song-item';
        item.innerHTML = `
          <div class='song-meta'>
            <div>
              <div><strong>${s.title}</strong></div>
              <div class='muted'>${state.currentArtist.name} ‚Ä¢ ${s.duration}</div>
            </div>
          </div>
          <div style='display:flex;gap:8px;align-items:center'>
            <button class='play-btn' onclick="playSong('${state.currentArtist.id}','${s.id}','${s.title.replace(/'/g,"\\'")}')">‚ñ∂ Tocar</button>
            <button class='add-btn' onclick="addToPlaylist('${state.currentArtist.id}','${s.id}')">+ Playlist</button>
            <button class='like-btn' id='like-${state.currentArtist.id}-${s.id}' onclick="toggleLike('${state.currentArtist.id}','${s.id}','${s.title.replace(/'/g,"\\'")}')">üíö</button>
          </div>
        `;
        songListEl.appendChild(item);
        updateLikeButton(state.currentArtist.id, s.id);
      });
    }

    // Playlist and likes
    function persist(){
      localStorage.setItem('lucasfy_playlist', JSON.stringify(state.playlist));
      localStorage.setItem('lucasfy_liked', JSON.stringify(Array.from(state.liked)));
    }

    function addToPlaylist(artistId, songId){
      const artist = DB.find(a=>a.id===artistId);
      const song = artist.songs.find(s=>s.id===songId);
      const entry = {artist:artist.name, artistId, songId, title:song.title, duration:song.duration, uid: Date.now()+Math.random()}
      state.playlist.push(entry);
      persist(); renderPlaylist();
    }

    function removeFromPlaylist(uid){
      state.playlist = state.playlist.filter(p=>p.uid!==uid);
      persist(); renderPlaylist();
    }

    function renderPlaylist(){
      playlistEl.innerHTML = '';
      if(state.playlist.length===0){playlistEl.innerHTML='<div class="muted">Sua playlist est√° vazia. Adicione m√∫sicas clicando em + Playlist.</div>';return}
      state.playlist.forEach(p=>{
        const el = document.createElement('div'); el.className='list-item';
        el.innerHTML = `<div><strong>${p.title}</strong><div class='muted'>${p.artist} ‚Ä¢ ${p.duration}</div></div><div style='display:flex;gap:8px'><button class='pill' onclick="playSong('${p.artistId}','${p.songId}','${p.title.replace(/'/g,"\\'")}')">‚ñ∂</button><button class='pill' onclick="removeFromPlaylist(${p.uid})">Remover</button></div>`;
        playlistEl.appendChild(el);
      });
    }

    function toggleLike(artistId, songId, title){
      const key = `${artistId}::${songId}`;
      if(state.liked.has(key)) state.liked.delete(key); else state.liked.add(key);
      persist(); renderLiked(); updateLikeButton(artistId, songId);
    }

    function updateLikeButton(artistId, songId){
      const id = `like-${artistId}-${songId}`;
      const btn = document.getElementById(id);
      if(!btn) return;
      const key = `${artistId}::${songId}`;
      btn.textContent = state.liked.has(key)? 'üíö Curtido' : 'üíö';
    }

    function renderLiked(){
      likedListEl.innerHTML = '';
      const arr = Array.from(state.liked).map(k=>{
        const [artistId,songId] = k.split('::');
        const artist = DB.find(a=>a.id===artistId);
        const song = artist.songs.find(s=>s.id===songId);
        return {artistId, songId, title:song.title, artist:artist.name, key:k};
      });
      if(arr.length===0){likedListEl.innerHTML='<div class="muted">Nenhuma m√∫sica curtida ainda.</div>';return}
      arr.forEach(item=>{
        const el = document.createElement('div'); el.className='list-item';
        el.innerHTML = `<div><strong>${item.title}</strong><div class='muted'>${item.artist}</div></div><div style='display:flex;gap:6px'><button class='pill' onclick="playSong('${item.artistId}','${item.songId}','${item.title.replace(/'/g,"\\'")}')">‚ñ∂</button><button class='pill' onclick="toggleLike('${item.artistId}','${item.songId}')">Remover</button></div>`;
        likedListEl.appendChild(el);
      });
    }

    // Player controls
    function playSong(artistId, songId, title){
      // resume context if needed
      if(audioCtx.state === 'suspended') audioCtx.resume();
      state.playing = {artistId, songId, title};
      nowPlayingEl.textContent = `‚ñ∂ Tocando: ${title}`;
      // simulate playback with synthesized tone; duration based on DB if available
      const artist = DB.find(a=>a.id===artistId);
      const song = artist && artist.songs.find(s=>s.id===songId);
      let sec = 3;
      if(song){
        const parts = song.duration.split(':'); sec = parseInt(parts[0])*60 + parseInt(parts[1]);
        // shorten for demo
        sec = Math.min(10, Math.max(2, Math.round(sec/30)));
      }
      playTone(sec);
    }

    document.getElementById('stopBtn').onclick = ()=>{ stopTone(); state.playing=null; nowPlayingEl.textContent='Parado'; }

    // clear localStorage
    document.getElementById('clearStorage').onclick = ()=>{
      if(confirm('Deseja realmente limpar playlist e m√∫sicas curtidas?')){
        state.playlist=[]; state.liked=new Set(); persist(); renderPlaylist(); renderLiked(); alert('Dados locais limpos.');
      }
    }

    // initial render
    renderArtists(); renderPlaylist(); renderLiked();

    // expose some functions for inline handlers (because we used onclick in generated HTML)
    window.selectArtist = selectArtist;
    window.playSong = playSong;
    window.addToPlaylist = addToPlaylist;
    window.toggleLike = toggleLike;
    window.removeFromPlaylist = function(uid){ removeFromPlaylist(uid); };

    // accessibility: select first artist by default
    selectArtist(DB[0].id);
  </script>
</body>
</html>
